<h1>Legal AI Chat Demo</h1>

<div id="chat-container" style="border:1px solid #ccc; padding:10px; min-height:150px;"></div>

<input type="text" id="user-message" placeholder="Type your message...">
<button id="send-btn">Send</button>
<button id="save-btn">Save Chat</button>

<script>
async function sendMessage() {
  const msgInput = document.getElementById("user-message")
  const message = msgInput.value
  if (!message) return

  const res = await fetch("/chat", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ message })
  })
  const data = await res.json()

  const container = document.getElementById("chat-container")
  container.innerHTML += `<p><b>You:</b> ${message}</p>`
  container.innerHTML += `<p><b>AI:</b> ${data.reply}</p>`

  if(data.lead_capture){
    container.innerHTML += `<p style="color:red;"><b>Lead detected!</b></p>`
  }

  msgInput.value = ""
}

document.getElementById("send-btn").onclick = sendMessage

document.getElementById("save-btn").onclick = async () => {
  const res = await fetch("/summary", { method: "POST" })
  const data = await res.json()
  alert(data.status === "saved" ? "Chat saved!" : "Failed to save chat")
}
</script>
